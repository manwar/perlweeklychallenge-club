#!/usr/bin/env raku
use JSON::Fast;
use Test;

is-deeply magic-expression("123",   6), ("1*2*3", "1+2+3");
is-deeply magic-expression("105",   5), ("1*0+5", "10-5");
is-deeply magic-expression("232",   8), ("2*3+2", "2+3*2");
is-deeply magic-expression("1234", 10), ("1*2*3+4", "1+2+3+4");
is-deeply magic-expression("1001",  2), ("1+0*0+1", "1+0+0+1", "1+0-0+1", "1-0*0+1", "1-0+0+1", "1-0-0+1");

#
# With help from https://andrewshitov.com/2018/10/31/creating-a-calculator-with-perl-6-grammars/
#

grammar Calculate 
{
    rule  TOP    { <add>           }
    rule  add    { <subt>+   % '+' }
    rule  subt   { <mult>+   % '-' }
    rule  mult   { <digits>+ % '*' }
    rule  digits { <digit>+        }
}

class Actions 
{
    method TOP   ($/) { make $<add>.made          }
    method add   ($/) { make [+] $<subt>>>.made   }
    method subt  ($/) { make [-] $<mult>>>.made   }
    method mult  ($/) { make [*] $<digits>>>.made }
    method digits($/) { make $/.UInt              }
}

multi magic-expression($str where *.chars > 7, $target) 
{
    note "This is a brute force solution: \$str must be 7 characters or less"
}
 
multi magic-expression($str, $target)
{
    my @nums = $str.comb;
    my (@partitions, @operators) := from-json $=finish;

    gather for @partitions[@nums-2]<> -> @p
    {
        my @r = @nums.rotor(@p)>>.join;
        next if any @r ~~ /^0<digit>/;

        for @operators[@p-2]<> -> @o
        {
            my $exp = flat roundrobin @r, @o;
            take [~] $exp if Calculate.parse($exp, :actions(Actions)).made == $target
        }
    }
}

=finish

[
    [
        [
            [1,1]
        ],

        [
            [1,1,1],
            [1,2],
            [2,1]
        ],

        [
            [1,1,1,1],
            [1,1,2],
            [1,2,1],
            [2,1,1],
            [1,3],
            [3,1],
            [2,2] 
        ],

        [
            [1,1,1,1,1],
            [1,1,1,2],
            [1,1,2,1],
            [1,2,1,1],
            [2,1,1,1],
            [1,1,3],
            [1,3,1],
            [3,1,1],
            [1,2,2],
            [2,1,2],
            [2,2,1],
            [1,4],
            [4,1],
            [2,3],
            [3,2]
        ],

        [
            [1,1,1,1,1,1],
            [1,1,1,1,2],
            [1,1,1,2,1],
            [1,1,2,1,1],
            [1,2,1,1,1],
            [2,1,1,1,1],
            [1,1,1,3],
            [1,1,3,1],
            [1,3,1,1],
            [3,1,1,1],
            [1,1,2,2],
            [1,2,1,2],
            [1,2,2,1],
            [2,1,1,2],
            [2,1,2,1],
            [2,2,1,1],
            [1,1,4],
            [1,4,1],
            [4,1,1],
            [1,2,3],
            [1,3,2],
            [2,1,3],
            [2,3,1],
            [3,1,2],
            [3,2,1],
            [1,5],
            [5,1],
            [2,2,2],
            [2,4],
            [4,2],
            [3,3]
        ],

        [
            [1,1,1,1,1,1,1],
            [1,1,1,1,1,2],
            [1,1,1,1,2,1],
            [1,1,1,2,1,1],
            [1,1,2,1,1,1],
            [1,2,1,1,1,1],
            [2,1,1,1,1,1],
            [1,1,1,1,3],
            [1,1,1,3,1],
            [1,1,3,1,1],
            [1,3,1,1,1],
            [3,1,1,1,1],
            [1,1,1,2,2],
            [1,1,2,1,2],
            [1,1,2,2,1],
            [1,2,1,1,2],
            [1,2,1,2,1],
            [1,2,2,1,1],
            [2,1,1,1,2],
            [2,1,1,2,1],
            [2,1,2,1,1],
            [2,2,1,1,1],
            [1,1,1,4],
            [1,1,4,1],
            [1,4,1,1],
            [4,1,1,1],
            [1,1,2,3],
            [1,1,3,2],
            [1,2,1,3],
            [1,2,3,1],
            [1,3,1,2],
            [1,3,2,1],
            [2,1,1,3],
            [2,1,3,1],
            [2,3,1,1],
            [3,1,1,2],
            [3,1,2,1],
            [3,2,1,1],
            [1,1,5],
            [1,5,1],
            [5,1,1],
            [1,2,2,2],
            [2,1,2,2],
            [2,2,1,2],
            [2,2,2,1],
            [1,2,4],
            [1,4,2],
            [2,1,4],
            [2,4,1],
            [4,1,2],
            [4,2,1],
            [1,3,3],
            [3,1,3],
            [3,3,1],
            [1,6],
            [6,1],
            [2,2,3],
            [2,3,2],
            [3,2,2],
            [2,5],
            [5,2],
            [3,4],
            [4,3]
        ]
    ],

    [
        [
            ["*"],["+"],["-"]
        ],

        [
            ["*","*"],
            ["*","+"],
            ["*","-"],
            ["+","*"],
            ["+","+"],
            ["+","-"],
            ["-","*"],
            ["-","+"],
            ["-","-"]
        ],

        [
            ["*","*","*"],
            ["*","*","+"],
            ["*","*","-"],
            ["*","+","*"],
            ["*","+","+"],
            ["*","+","-"],
            ["*","-","*"],
            ["*","-","+"],
            ["*","-","-"],
            ["+","*","*"],
            ["+","*","+"],
            ["+","*","-"],
            ["+","+","*"],
            ["+","+","+"],
            ["+","+","-"],
            ["+","-","*"],
            ["+","-","+"],
            ["+","-","-"],
            ["-","*","*"],
            ["-","*","+"],
            ["-","*","-"],
            ["-","+","*"],
            ["-","+","+"],
            ["-","+","-"],
            ["-","-","*"],
            ["-","-","+"],
            ["-","-","-"]
        ],

        [
            ["*","*","*","*"],
            ["*","*","*","+"],
            ["*","*","*","-"],
            ["*","*","+","*"],
            ["*","*","+","+"],
            ["*","*","+","-"],
            ["*","*","-","*"],
            ["*","*","-","+"],
            ["*","*","-","-"],
            ["*","+","*","*"],
            ["*","+","*","+"],
            ["*","+","*","-"],
            ["*","+","+","*"],
            ["*","+","+","+"],
            ["*","+","+","-"],
            ["*","+","-","*"],
            ["*","+","-","+"],
            ["*","+","-","-"],
            ["*","-","*","*"],
            ["*","-","*","+"],
            ["*","-","*","-"],
            ["*","-","+","*"],
            ["*","-","+","+"],
            ["*","-","+","-"],
            ["*","-","-","*"],
            ["*","-","-","+"],
            ["*","-","-","-"],
            ["+","*","*","*"],
            ["+","*","*","+"],
            ["+","*","*","-"],
            ["+","*","+","*"],
            ["+","*","+","+"],
            ["+","*","+","-"],
            ["+","*","-","*"],
            ["+","*","-","+"],
            ["+","*","-","-"],
            ["+","+","*","*"],
            ["+","+","*","+"],
            ["+","+","*","-"],
            ["+","+","+","*"],
            ["+","+","+","+"],
            ["+","+","+","-"],
            ["+","+","-","*"],
            ["+","+","-","+"],
            ["+","+","-","-"],
            ["+","-","*","*"],
            ["+","-","*","+"],
            ["+","-","*","-"],
            ["+","-","+","*"],
            ["+","-","+","+"],
            ["+","-","+","-"],
            ["+","-","-","*"],
            ["+","-","-","+"],
            ["+","-","-","-"],
            ["-","*","*","*"],
            ["-","*","*","+"],
            ["-","*","*","-"],
            ["-","*","+","*"],
            ["-","*","+","+"],
            ["-","*","+","-"],
            ["-","*","-","*"],
            ["-","*","-","+"],
            ["-","*","-","-"],
            ["-","+","*","*"],
            ["-","+","*","+"],
            ["-","+","*","-"],
            ["-","+","+","*"],
            ["-","+","+","+"],
            ["-","+","+","-"],
            ["-","+","-","*"],
            ["-","+","-","+"],
            ["-","+","-","-"],
            ["-","-","*","*"],
            ["-","-","*","+"],
            ["-","-","*","-"],
            ["-","-","+","*"],
            ["-","-","+","+"],
            ["-","-","+","-"],
            ["-","-","-","*"],
            ["-","-","-","+"],
            ["-","-","-","-"]
        ],

        [
            ["*","*","*","*","*"],
            ["*","*","*","*","+"],
            ["*","*","*","*","-"],
            ["*","*","*","+","*"],
            ["*","*","*","+","+"],
            ["*","*","*","+","-"],
            ["*","*","*","-","*"],
            ["*","*","*","-","+"],
            ["*","*","*","-","-"],
            ["*","*","+","*","*"],
            ["*","*","+","*","+"],
            ["*","*","+","*","-"],
            ["*","*","+","+","*"],
            ["*","*","+","+","+"],
            ["*","*","+","+","-"],
            ["*","*","+","-","*"],
            ["*","*","+","-","+"],
            ["*","*","+","-","-"],
            ["*","*","-","*","*"],
            ["*","*","-","*","+"],
            ["*","*","-","*","-"],
            ["*","*","-","+","*"],
            ["*","*","-","+","+"],
            ["*","*","-","+","-"],
            ["*","*","-","-","*"],
            ["*","*","-","-","+"],
            ["*","*","-","-","-"],
            ["*","+","*","*","*"],
            ["*","+","*","*","+"],
            ["*","+","*","*","-"],
            ["*","+","*","+","*"],
            ["*","+","*","+","+"],
            ["*","+","*","+","-"],
            ["*","+","*","-","*"],
            ["*","+","*","-","+"],
            ["*","+","*","-","-"],
            ["*","+","+","*","*"],
            ["*","+","+","*","+"],
            ["*","+","+","*","-"],
            ["*","+","+","+","*"],
            ["*","+","+","+","+"],
            ["*","+","+","+","-"],
            ["*","+","+","-","*"],
            ["*","+","+","-","+"],
            ["*","+","+","-","-"],
            ["*","+","-","*","*"],
            ["*","+","-","*","+"],
            ["*","+","-","*","-"],
            ["*","+","-","+","*"],
            ["*","+","-","+","+"],
            ["*","+","-","+","-"],
            ["*","+","-","-","*"],
            ["*","+","-","-","+"],
            ["*","+","-","-","-"],
            ["*","-","*","*","*"],
            ["*","-","*","*","+"],
            ["*","-","*","*","-"],
            ["*","-","*","+","*"],
            ["*","-","*","+","+"],
            ["*","-","*","+","-"],
            ["*","-","*","-","*"],
            ["*","-","*","-","+"],
            ["*","-","*","-","-"],
            ["*","-","+","*","*"],
            ["*","-","+","*","+"],
            ["*","-","+","*","-"],
            ["*","-","+","+","*"],
            ["*","-","+","+","+"],
            ["*","-","+","+","-"],
            ["*","-","+","-","*"],
            ["*","-","+","-","+"],
            ["*","-","+","-","-"],
            ["*","-","-","*","*"],
            ["*","-","-","*","+"],
            ["*","-","-","*","-"],
            ["*","-","-","+","*"],
            ["*","-","-","+","+"],
            ["*","-","-","+","-"],
            ["*","-","-","-","*"],
            ["*","-","-","-","+"],
            ["*","-","-","-","-"],
            ["+","*","*","*","*"],
            ["+","*","*","*","+"],
            ["+","*","*","*","-"],
            ["+","*","*","+","*"],
            ["+","*","*","+","+"],
            ["+","*","*","+","-"],
            ["+","*","*","-","*"],
            ["+","*","*","-","+"],
            ["+","*","*","-","-"],
            ["+","*","+","*","*"],
            ["+","*","+","*","+"],
            ["+","*","+","*","-"],
            ["+","*","+","+","*"],
            ["+","*","+","+","+"],
            ["+","*","+","+","-"],
            ["+","*","+","-","*"],
            ["+","*","+","-","+"],
            ["+","*","+","-","-"],
            ["+","*","-","*","*"],
            ["+","*","-","*","+"],
            ["+","*","-","*","-"],
            ["+","*","-","+","*"],
            ["+","*","-","+","+"],
            ["+","*","-","+","-"],
            ["+","*","-","-","*"],
            ["+","*","-","-","+"],
            ["+","*","-","-","-"],
            ["+","+","*","*","*"],
            ["+","+","*","*","+"],
            ["+","+","*","*","-"],
            ["+","+","*","+","*"],
            ["+","+","*","+","+"],
            ["+","+","*","+","-"],
            ["+","+","*","-","*"],
            ["+","+","*","-","+"],
            ["+","+","*","-","-"],
            ["+","+","+","*","*"],
            ["+","+","+","*","+"],
            ["+","+","+","*","-"],
            ["+","+","+","+","*"],
            ["+","+","+","+","+"],
            ["+","+","+","+","-"],
            ["+","+","+","-","*"],
            ["+","+","+","-","+"],
            ["+","+","+","-","-"],
            ["+","+","-","*","*"],
            ["+","+","-","*","+"],
            ["+","+","-","*","-"],
            ["+","+","-","+","*"],
            ["+","+","-","+","+"],
            ["+","+","-","+","-"],
            ["+","+","-","-","*"],
            ["+","+","-","-","+"],
            ["+","+","-","-","-"],
            ["+","-","*","*","*"],
            ["+","-","*","*","+"],
            ["+","-","*","*","-"],
            ["+","-","*","+","*"],
            ["+","-","*","+","+"],
            ["+","-","*","+","-"],
            ["+","-","*","-","*"],
            ["+","-","*","-","+"],
            ["+","-","*","-","-"],
            ["+","-","+","*","*"],
            ["+","-","+","*","+"],
            ["+","-","+","*","-"],
            ["+","-","+","+","*"],
            ["+","-","+","+","+"],
            ["+","-","+","+","-"],
            ["+","-","+","-","*"],
            ["+","-","+","-","+"],
            ["+","-","+","-","-"],
            ["+","-","-","*","*"],
            ["+","-","-","*","+"],
            ["+","-","-","*","-"],
            ["+","-","-","+","*"],
            ["+","-","-","+","+"],
            ["+","-","-","+","-"],
            ["+","-","-","-","*"],
            ["+","-","-","-","+"],
            ["+","-","-","-","-"],
            ["-","*","*","*","*"],
            ["-","*","*","*","+"],
            ["-","*","*","*","-"],
            ["-","*","*","+","*"],
            ["-","*","*","+","+"],
            ["-","*","*","+","-"],
            ["-","*","*","-","*"],
            ["-","*","*","-","+"],
            ["-","*","*","-","-"],
            ["-","*","+","*","*"],
            ["-","*","+","*","+"],
            ["-","*","+","*","-"],
            ["-","*","+","+","*"],
            ["-","*","+","+","+"],
            ["-","*","+","+","-"],
            ["-","*","+","-","*"],
            ["-","*","+","-","+"],
            ["-","*","+","-","-"],
            ["-","*","-","*","*"],
            ["-","*","-","*","+"],
            ["-","*","-","*","-"],
            ["-","*","-","+","*"],
            ["-","*","-","+","+"],
            ["-","*","-","+","-"],
            ["-","*","-","-","*"],
            ["-","*","-","-","+"],
            ["-","*","-","-","-"],
            ["-","+","*","*","*"],
            ["-","+","*","*","+"],
            ["-","+","*","*","-"],
            ["-","+","*","+","*"],
            ["-","+","*","+","+"],
            ["-","+","*","+","-"],
            ["-","+","*","-","*"],
            ["-","+","*","-","+"],
            ["-","+","*","-","-"],
            ["-","+","+","*","*"],
            ["-","+","+","*","+"],
            ["-","+","+","*","-"],
            ["-","+","+","+","*"],
            ["-","+","+","+","+"],
            ["-","+","+","+","-"],
            ["-","+","+","-","*"],
            ["-","+","+","-","+"],
            ["-","+","+","-","-"],
            ["-","+","-","*","*"],
            ["-","+","-","*","+"],
            ["-","+","-","*","-"],
            ["-","+","-","+","*"],
            ["-","+","-","+","+"],
            ["-","+","-","+","-"],
            ["-","+","-","-","*"],
            ["-","+","-","-","+"],
            ["-","+","-","-","-"],
            ["-","-","*","*","*"],
            ["-","-","*","*","+"],
            ["-","-","*","*","-"],
            ["-","-","*","+","*"],
            ["-","-","*","+","+"],
            ["-","-","*","+","-"],
            ["-","-","*","-","*"],
            ["-","-","*","-","+"],
            ["-","-","*","-","-"],
            ["-","-","+","*","*"],
            ["-","-","+","*","+"],
            ["-","-","+","*","-"],
            ["-","-","+","+","*"],
            ["-","-","+","+","+"],
            ["-","-","+","+","-"],
            ["-","-","+","-","*"],
            ["-","-","+","-","+"],
            ["-","-","+","-","-"],
            ["-","-","-","*","*"],
            ["-","-","-","*","+"],
            ["-","-","-","*","-"],
            ["-","-","-","+","*"],
            ["-","-","-","+","+"],
            ["-","-","-","+","-"],
            ["-","-","-","-","*"],
            ["-","-","-","-","+"],
            ["-","-","-","-","-"]
        ],
            
        [
            ["*","*","*","*","*","*"],
            ["*","*","*","*","*","+"],
            ["*","*","*","*","*","-"],
            ["*","*","*","*","+","*"],
            ["*","*","*","*","+","+"],
            ["*","*","*","*","+","-"],
            ["*","*","*","*","-","*"],
            ["*","*","*","*","-","+"],
            ["*","*","*","*","-","-"],
            ["*","*","*","+","*","*"],
            ["*","*","*","+","*","+"],
            ["*","*","*","+","*","-"],
            ["*","*","*","+","+","*"],
            ["*","*","*","+","+","+"],
            ["*","*","*","+","+","-"],
            ["*","*","*","+","-","*"],
            ["*","*","*","+","-","+"],
            ["*","*","*","+","-","-"],
            ["*","*","*","-","*","*"],
            ["*","*","*","-","*","+"],
            ["*","*","*","-","*","-"],
            ["*","*","*","-","+","*"],
            ["*","*","*","-","+","+"],
            ["*","*","*","-","+","-"],
            ["*","*","*","-","-","*"],
            ["*","*","*","-","-","+"],
            ["*","*","*","-","-","-"],
            ["*","*","+","*","*","*"],
            ["*","*","+","*","*","+"],
            ["*","*","+","*","*","-"],
            ["*","*","+","*","+","*"],
            ["*","*","+","*","+","+"],
            ["*","*","+","*","+","-"],
            ["*","*","+","*","-","*"],
            ["*","*","+","*","-","+"],
            ["*","*","+","*","-","-"],
            ["*","*","+","+","*","*"],
            ["*","*","+","+","*","+"],
            ["*","*","+","+","*","-"],
            ["*","*","+","+","+","*"],
            ["*","*","+","+","+","+"],
            ["*","*","+","+","+","-"],
            ["*","*","+","+","-","*"],
            ["*","*","+","+","-","+"],
            ["*","*","+","+","-","-"],
            ["*","*","+","-","*","*"],
            ["*","*","+","-","*","+"],
            ["*","*","+","-","*","-"],
            ["*","*","+","-","+","*"],
            ["*","*","+","-","+","+"],
            ["*","*","+","-","+","-"],
            ["*","*","+","-","-","*"],
            ["*","*","+","-","-","+"],
            ["*","*","+","-","-","-"],
            ["*","*","-","*","*","*"],
            ["*","*","-","*","*","+"],
            ["*","*","-","*","*","-"],
            ["*","*","-","*","+","*"],
            ["*","*","-","*","+","+"],
            ["*","*","-","*","+","-"],
            ["*","*","-","*","-","*"],
            ["*","*","-","*","-","+"],
            ["*","*","-","*","-","-"],
            ["*","*","-","+","*","*"],
            ["*","*","-","+","*","+"],
            ["*","*","-","+","*","-"],
            ["*","*","-","+","+","*"],
            ["*","*","-","+","+","+"],
            ["*","*","-","+","+","-"],
            ["*","*","-","+","-","*"],
            ["*","*","-","+","-","+"],
            ["*","*","-","+","-","-"],
            ["*","*","-","-","*","*"],
            ["*","*","-","-","*","+"],
            ["*","*","-","-","*","-"],
            ["*","*","-","-","+","*"],
            ["*","*","-","-","+","+"],
            ["*","*","-","-","+","-"],
            ["*","*","-","-","-","*"],
            ["*","*","-","-","-","+"],
            ["*","*","-","-","-","-"],
            ["*","+","*","*","*","*"],
            ["*","+","*","*","*","+"],
            ["*","+","*","*","*","-"],
            ["*","+","*","*","+","*"],
            ["*","+","*","*","+","+"],
            ["*","+","*","*","+","-"],
            ["*","+","*","*","-","*"],
            ["*","+","*","*","-","+"],
            ["*","+","*","*","-","-"],
            ["*","+","*","+","*","*"],
            ["*","+","*","+","*","+"],
            ["*","+","*","+","*","-"],
            ["*","+","*","+","+","*"],
            ["*","+","*","+","+","+"],
            ["*","+","*","+","+","-"],
            ["*","+","*","+","-","*"],
            ["*","+","*","+","-","+"],
            ["*","+","*","+","-","-"],
            ["*","+","*","-","*","*"],
            ["*","+","*","-","*","+"],
            ["*","+","*","-","*","-"],
            ["*","+","*","-","+","*"],
            ["*","+","*","-","+","+"],
            ["*","+","*","-","+","-"],
            ["*","+","*","-","-","*"],
            ["*","+","*","-","-","+"],
            ["*","+","*","-","-","-"],
            ["*","+","+","*","*","*"],
            ["*","+","+","*","*","+"],
            ["*","+","+","*","*","-"],
            ["*","+","+","*","+","*"],
            ["*","+","+","*","+","+"],
            ["*","+","+","*","+","-"],
            ["*","+","+","*","-","*"],
            ["*","+","+","*","-","+"],
            ["*","+","+","*","-","-"],
            ["*","+","+","+","*","*"],
            ["*","+","+","+","*","+"],
            ["*","+","+","+","*","-"],
            ["*","+","+","+","+","*"],
            ["*","+","+","+","+","+"],
            ["*","+","+","+","+","-"],
            ["*","+","+","+","-","*"],
            ["*","+","+","+","-","+"],
            ["*","+","+","+","-","-"],
            ["*","+","+","-","*","*"],
            ["*","+","+","-","*","+"],
            ["*","+","+","-","*","-"],
            ["*","+","+","-","+","*"],
            ["*","+","+","-","+","+"],
            ["*","+","+","-","+","-"],
            ["*","+","+","-","-","*"],
            ["*","+","+","-","-","+"],
            ["*","+","+","-","-","-"],
            ["*","+","-","*","*","*"],
            ["*","+","-","*","*","+"],
            ["*","+","-","*","*","-"],
            ["*","+","-","*","+","*"],
            ["*","+","-","*","+","+"],
            ["*","+","-","*","+","-"],
            ["*","+","-","*","-","*"],
            ["*","+","-","*","-","+"],
            ["*","+","-","*","-","-"],
            ["*","+","-","+","*","*"],
            ["*","+","-","+","*","+"],
            ["*","+","-","+","*","-"],
            ["*","+","-","+","+","*"],
            ["*","+","-","+","+","+"],
            ["*","+","-","+","+","-"],
            ["*","+","-","+","-","*"],
            ["*","+","-","+","-","+"],
            ["*","+","-","+","-","-"],
            ["*","+","-","-","*","*"],
            ["*","+","-","-","*","+"],
            ["*","+","-","-","*","-"],
            ["*","+","-","-","+","*"],
            ["*","+","-","-","+","+"],
            ["*","+","-","-","+","-"],
            ["*","+","-","-","-","*"],
            ["*","+","-","-","-","+"],
            ["*","+","-","-","-","-"],
            ["*","-","*","*","*","*"],
            ["*","-","*","*","*","+"],
            ["*","-","*","*","*","-"],
            ["*","-","*","*","+","*"],
            ["*","-","*","*","+","+"],
            ["*","-","*","*","+","-"],
            ["*","-","*","*","-","*"],
            ["*","-","*","*","-","+"],
            ["*","-","*","*","-","-"],
            ["*","-","*","+","*","*"],
            ["*","-","*","+","*","+"],
            ["*","-","*","+","*","-"],
            ["*","-","*","+","+","*"],
            ["*","-","*","+","+","+"],
            ["*","-","*","+","+","-"],
            ["*","-","*","+","-","*"],
            ["*","-","*","+","-","+"],
            ["*","-","*","+","-","-"],
            ["*","-","*","-","*","*"],
            ["*","-","*","-","*","+"],
            ["*","-","*","-","*","-"],
            ["*","-","*","-","+","*"],
            ["*","-","*","-","+","+"],
            ["*","-","*","-","+","-"],
            ["*","-","*","-","-","*"],
            ["*","-","*","-","-","+"],
            ["*","-","*","-","-","-"],
            ["*","-","+","*","*","*"],
            ["*","-","+","*","*","+"],
            ["*","-","+","*","*","-"],
            ["*","-","+","*","+","*"],
            ["*","-","+","*","+","+"],
            ["*","-","+","*","+","-"],
            ["*","-","+","*","-","*"],
            ["*","-","+","*","-","+"],
            ["*","-","+","*","-","-"],
            ["*","-","+","+","*","*"],
            ["*","-","+","+","*","+"],
            ["*","-","+","+","*","-"],
            ["*","-","+","+","+","*"],
            ["*","-","+","+","+","+"],
            ["*","-","+","+","+","-"],
            ["*","-","+","+","-","*"],
            ["*","-","+","+","-","+"],
            ["*","-","+","+","-","-"],
            ["*","-","+","-","*","*"],
            ["*","-","+","-","*","+"],
            ["*","-","+","-","*","-"],
            ["*","-","+","-","+","*"],
            ["*","-","+","-","+","+"],
            ["*","-","+","-","+","-"],
            ["*","-","+","-","-","*"],
            ["*","-","+","-","-","+"],
            ["*","-","+","-","-","-"],
            ["*","-","-","*","*","*"],
            ["*","-","-","*","*","+"],
            ["*","-","-","*","*","-"],
            ["*","-","-","*","+","*"],
            ["*","-","-","*","+","+"],
            ["*","-","-","*","+","-"],
            ["*","-","-","*","-","*"],
            ["*","-","-","*","-","+"],
            ["*","-","-","*","-","-"],
            ["*","-","-","+","*","*"],
            ["*","-","-","+","*","+"],
            ["*","-","-","+","*","-"],
            ["*","-","-","+","+","*"],
            ["*","-","-","+","+","+"],
            ["*","-","-","+","+","-"],
            ["*","-","-","+","-","*"],
            ["*","-","-","+","-","+"],
            ["*","-","-","+","-","-"],
            ["*","-","-","-","*","*"],
            ["*","-","-","-","*","+"],
            ["*","-","-","-","*","-"],
            ["*","-","-","-","+","*"],
            ["*","-","-","-","+","+"],
            ["*","-","-","-","+","-"],
            ["*","-","-","-","-","*"],
            ["*","-","-","-","-","+"],
            ["*","-","-","-","-","-"],
            ["+","*","*","*","*","*"],
            ["+","*","*","*","*","+"],
            ["+","*","*","*","*","-"],
            ["+","*","*","*","+","*"],
            ["+","*","*","*","+","+"],
            ["+","*","*","*","+","-"],
            ["+","*","*","*","-","*"],
            ["+","*","*","*","-","+"],
            ["+","*","*","*","-","-"],
            ["+","*","*","+","*","*"],
            ["+","*","*","+","*","+"],
            ["+","*","*","+","*","-"],
            ["+","*","*","+","+","*"],
            ["+","*","*","+","+","+"],
            ["+","*","*","+","+","-"],
            ["+","*","*","+","-","*"],
            ["+","*","*","+","-","+"],
            ["+","*","*","+","-","-"],
            ["+","*","*","-","*","*"],
            ["+","*","*","-","*","+"],
            ["+","*","*","-","*","-"],
            ["+","*","*","-","+","*"],
            ["+","*","*","-","+","+"],
            ["+","*","*","-","+","-"],
            ["+","*","*","-","-","*"],
            ["+","*","*","-","-","+"],
            ["+","*","*","-","-","-"],
            ["+","*","+","*","*","*"],
            ["+","*","+","*","*","+"],
            ["+","*","+","*","*","-"],
            ["+","*","+","*","+","*"],
            ["+","*","+","*","+","+"],
            ["+","*","+","*","+","-"],
            ["+","*","+","*","-","*"],
            ["+","*","+","*","-","+"],
            ["+","*","+","*","-","-"],
            ["+","*","+","+","*","*"],
            ["+","*","+","+","*","+"],
            ["+","*","+","+","*","-"],
            ["+","*","+","+","+","*"],
            ["+","*","+","+","+","+"],
            ["+","*","+","+","+","-"],
            ["+","*","+","+","-","*"],
            ["+","*","+","+","-","+"],
            ["+","*","+","+","-","-"],
            ["+","*","+","-","*","*"],
            ["+","*","+","-","*","+"],
            ["+","*","+","-","*","-"],
            ["+","*","+","-","+","*"],
            ["+","*","+","-","+","+"],
            ["+","*","+","-","+","-"],
            ["+","*","+","-","-","*"],
            ["+","*","+","-","-","+"],
            ["+","*","+","-","-","-"],
            ["+","*","-","*","*","*"],
            ["+","*","-","*","*","+"],
            ["+","*","-","*","*","-"],
            ["+","*","-","*","+","*"],
            ["+","*","-","*","+","+"],
            ["+","*","-","*","+","-"],
            ["+","*","-","*","-","*"],
            ["+","*","-","*","-","+"],
            ["+","*","-","*","-","-"],
            ["+","*","-","+","*","*"],
            ["+","*","-","+","*","+"],
            ["+","*","-","+","*","-"],
            ["+","*","-","+","+","*"],
            ["+","*","-","+","+","+"],
            ["+","*","-","+","+","-"],
            ["+","*","-","+","-","*"],
            ["+","*","-","+","-","+"],
            ["+","*","-","+","-","-"],
            ["+","*","-","-","*","*"],
            ["+","*","-","-","*","+"],
            ["+","*","-","-","*","-"],
            ["+","*","-","-","+","*"],
            ["+","*","-","-","+","+"],
            ["+","*","-","-","+","-"],
            ["+","*","-","-","-","*"],
            ["+","*","-","-","-","+"],
            ["+","*","-","-","-","-"],
            ["+","+","*","*","*","*"],
            ["+","+","*","*","*","+"],
            ["+","+","*","*","*","-"],
            ["+","+","*","*","+","*"],
            ["+","+","*","*","+","+"],
            ["+","+","*","*","+","-"],
            ["+","+","*","*","-","*"],
            ["+","+","*","*","-","+"],
            ["+","+","*","*","-","-"],
            ["+","+","*","+","*","*"],
            ["+","+","*","+","*","+"],
            ["+","+","*","+","*","-"],
            ["+","+","*","+","+","*"],
            ["+","+","*","+","+","+"],
            ["+","+","*","+","+","-"],
            ["+","+","*","+","-","*"],
            ["+","+","*","+","-","+"],
            ["+","+","*","+","-","-"],
            ["+","+","*","-","*","*"],
            ["+","+","*","-","*","+"],
            ["+","+","*","-","*","-"],
            ["+","+","*","-","+","*"],
            ["+","+","*","-","+","+"],
            ["+","+","*","-","+","-"],
            ["+","+","*","-","-","*"],
            ["+","+","*","-","-","+"],
            ["+","+","*","-","-","-"],
            ["+","+","+","*","*","*"],
            ["+","+","+","*","*","+"],
            ["+","+","+","*","*","-"],
            ["+","+","+","*","+","*"],
            ["+","+","+","*","+","+"],
            ["+","+","+","*","+","-"],
            ["+","+","+","*","-","*"],
            ["+","+","+","*","-","+"],
            ["+","+","+","*","-","-"],
            ["+","+","+","+","*","*"],
            ["+","+","+","+","*","+"],
            ["+","+","+","+","*","-"],
            ["+","+","+","+","+","*"],
            ["+","+","+","+","+","+"],
            ["+","+","+","+","+","-"],
            ["+","+","+","+","-","*"],
            ["+","+","+","+","-","+"],
            ["+","+","+","+","-","-"],
            ["+","+","+","-","*","*"],
            ["+","+","+","-","*","+"],
            ["+","+","+","-","*","-"],
            ["+","+","+","-","+","*"],
            ["+","+","+","-","+","+"],
            ["+","+","+","-","+","-"],
            ["+","+","+","-","-","*"],
            ["+","+","+","-","-","+"],
            ["+","+","+","-","-","-"],
            ["+","+","-","*","*","*"],
            ["+","+","-","*","*","+"],
            ["+","+","-","*","*","-"],
            ["+","+","-","*","+","*"],
            ["+","+","-","*","+","+"],
            ["+","+","-","*","+","-"],
            ["+","+","-","*","-","*"],
            ["+","+","-","*","-","+"],
            ["+","+","-","*","-","-"],
            ["+","+","-","+","*","*"],
            ["+","+","-","+","*","+"],
            ["+","+","-","+","*","-"],
            ["+","+","-","+","+","*"],
            ["+","+","-","+","+","+"],
            ["+","+","-","+","+","-"],
            ["+","+","-","+","-","*"],
            ["+","+","-","+","-","+"],
            ["+","+","-","+","-","-"],
            ["+","+","-","-","*","*"],
            ["+","+","-","-","*","+"],
            ["+","+","-","-","*","-"],
            ["+","+","-","-","+","*"],
            ["+","+","-","-","+","+"],
            ["+","+","-","-","+","-"],
            ["+","+","-","-","-","*"],
            ["+","+","-","-","-","+"],
            ["+","+","-","-","-","-"],
            ["+","-","*","*","*","*"],
            ["+","-","*","*","*","+"],
            ["+","-","*","*","*","-"],
            ["+","-","*","*","+","*"],
            ["+","-","*","*","+","+"],
            ["+","-","*","*","+","-"],
            ["+","-","*","*","-","*"],
            ["+","-","*","*","-","+"],
            ["+","-","*","*","-","-"],
            ["+","-","*","+","*","*"],
            ["+","-","*","+","*","+"],
            ["+","-","*","+","*","-"],
            ["+","-","*","+","+","*"],
            ["+","-","*","+","+","+"],
            ["+","-","*","+","+","-"],
            ["+","-","*","+","-","*"],
            ["+","-","*","+","-","+"],
            ["+","-","*","+","-","-"],
            ["+","-","*","-","*","*"],
            ["+","-","*","-","*","+"],
            ["+","-","*","-","*","-"],
            ["+","-","*","-","+","*"],
            ["+","-","*","-","+","+"],
            ["+","-","*","-","+","-"],
            ["+","-","*","-","-","*"],
            ["+","-","*","-","-","+"],
            ["+","-","*","-","-","-"],
            ["+","-","+","*","*","*"],
            ["+","-","+","*","*","+"],
            ["+","-","+","*","*","-"],
            ["+","-","+","*","+","*"],
            ["+","-","+","*","+","+"],
            ["+","-","+","*","+","-"],
            ["+","-","+","*","-","*"],
            ["+","-","+","*","-","+"],
            ["+","-","+","*","-","-"],
            ["+","-","+","+","*","*"],
            ["+","-","+","+","*","+"],
            ["+","-","+","+","*","-"],
            ["+","-","+","+","+","*"],
            ["+","-","+","+","+","+"],
            ["+","-","+","+","+","-"],
            ["+","-","+","+","-","*"],
            ["+","-","+","+","-","+"],
            ["+","-","+","+","-","-"],
            ["+","-","+","-","*","*"],
            ["+","-","+","-","*","+"],
            ["+","-","+","-","*","-"],
            ["+","-","+","-","+","*"],
            ["+","-","+","-","+","+"],
            ["+","-","+","-","+","-"],
            ["+","-","+","-","-","*"],
            ["+","-","+","-","-","+"],
            ["+","-","+","-","-","-"],
            ["+","-","-","*","*","*"],
            ["+","-","-","*","*","+"],
            ["+","-","-","*","*","-"],
            ["+","-","-","*","+","*"],
            ["+","-","-","*","+","+"],
            ["+","-","-","*","+","-"],
            ["+","-","-","*","-","*"],
            ["+","-","-","*","-","+"],
            ["+","-","-","*","-","-"],
            ["+","-","-","+","*","*"],
            ["+","-","-","+","*","+"],
            ["+","-","-","+","*","-"],
            ["+","-","-","+","+","*"],
            ["+","-","-","+","+","+"],
            ["+","-","-","+","+","-"],
            ["+","-","-","+","-","*"],
            ["+","-","-","+","-","+"],
            ["+","-","-","+","-","-"],
            ["+","-","-","-","*","*"],
            ["+","-","-","-","*","+"],
            ["+","-","-","-","*","-"],
            ["+","-","-","-","+","*"],
            ["+","-","-","-","+","+"],
            ["+","-","-","-","+","-"],
            ["+","-","-","-","-","*"],
            ["+","-","-","-","-","+"],
            ["+","-","-","-","-","-"],
            ["-","*","*","*","*","*"],
            ["-","*","*","*","*","+"],
            ["-","*","*","*","*","-"],
            ["-","*","*","*","+","*"],
            ["-","*","*","*","+","+"],
            ["-","*","*","*","+","-"],
            ["-","*","*","*","-","*"],
            ["-","*","*","*","-","+"],
            ["-","*","*","*","-","-"],
            ["-","*","*","+","*","*"],
            ["-","*","*","+","*","+"],
            ["-","*","*","+","*","-"],
            ["-","*","*","+","+","*"],
            ["-","*","*","+","+","+"],
            ["-","*","*","+","+","-"],
            ["-","*","*","+","-","*"],
            ["-","*","*","+","-","+"],
            ["-","*","*","+","-","-"],
            ["-","*","*","-","*","*"],
            ["-","*","*","-","*","+"],
            ["-","*","*","-","*","-"],
            ["-","*","*","-","+","*"],
            ["-","*","*","-","+","+"],
            ["-","*","*","-","+","-"],
            ["-","*","*","-","-","*"],
            ["-","*","*","-","-","+"],
            ["-","*","*","-","-","-"],
            ["-","*","+","*","*","*"],
            ["-","*","+","*","*","+"],
            ["-","*","+","*","*","-"],
            ["-","*","+","*","+","*"],
            ["-","*","+","*","+","+"],
            ["-","*","+","*","+","-"],
            ["-","*","+","*","-","*"],
            ["-","*","+","*","-","+"],
            ["-","*","+","*","-","-"],
            ["-","*","+","+","*","*"],
            ["-","*","+","+","*","+"],
            ["-","*","+","+","*","-"],
            ["-","*","+","+","+","*"],
            ["-","*","+","+","+","+"],
            ["-","*","+","+","+","-"],
            ["-","*","+","+","-","*"],
            ["-","*","+","+","-","+"],
            ["-","*","+","+","-","-"],
            ["-","*","+","-","*","*"],
            ["-","*","+","-","*","+"],
            ["-","*","+","-","*","-"],
            ["-","*","+","-","+","*"],
            ["-","*","+","-","+","+"],
            ["-","*","+","-","+","-"],
            ["-","*","+","-","-","*"],
            ["-","*","+","-","-","+"],
            ["-","*","+","-","-","-"],
            ["-","*","-","*","*","*"],
            ["-","*","-","*","*","+"],
            ["-","*","-","*","*","-"],
            ["-","*","-","*","+","*"],
            ["-","*","-","*","+","+"],
            ["-","*","-","*","+","-"],
            ["-","*","-","*","-","*"],
            ["-","*","-","*","-","+"],
            ["-","*","-","*","-","-"],
            ["-","*","-","+","*","*"],
            ["-","*","-","+","*","+"],
            ["-","*","-","+","*","-"],
            ["-","*","-","+","+","*"],
            ["-","*","-","+","+","+"],
            ["-","*","-","+","+","-"],
            ["-","*","-","+","-","*"],
            ["-","*","-","+","-","+"],
            ["-","*","-","+","-","-"],
            ["-","*","-","-","*","*"],
            ["-","*","-","-","*","+"],
            ["-","*","-","-","*","-"],
            ["-","*","-","-","+","*"],
            ["-","*","-","-","+","+"],
            ["-","*","-","-","+","-"],
            ["-","*","-","-","-","*"],
            ["-","*","-","-","-","+"],
            ["-","*","-","-","-","-"],
            ["-","+","*","*","*","*"],
            ["-","+","*","*","*","+"],
            ["-","+","*","*","*","-"],
            ["-","+","*","*","+","*"],
            ["-","+","*","*","+","+"],
            ["-","+","*","*","+","-"],
            ["-","+","*","*","-","*"],
            ["-","+","*","*","-","+"],
            ["-","+","*","*","-","-"],
            ["-","+","*","+","*","*"],
            ["-","+","*","+","*","+"],
            ["-","+","*","+","*","-"],
            ["-","+","*","+","+","*"],
            ["-","+","*","+","+","+"],
            ["-","+","*","+","+","-"],
            ["-","+","*","+","-","*"],
            ["-","+","*","+","-","+"],
            ["-","+","*","+","-","-"],
            ["-","+","*","-","*","*"],
            ["-","+","*","-","*","+"],
            ["-","+","*","-","*","-"],
            ["-","+","*","-","+","*"],
            ["-","+","*","-","+","+"],
            ["-","+","*","-","+","-"],
            ["-","+","*","-","-","*"],
            ["-","+","*","-","-","+"],
            ["-","+","*","-","-","-"],
            ["-","+","+","*","*","*"],
            ["-","+","+","*","*","+"],
            ["-","+","+","*","*","-"],
            ["-","+","+","*","+","*"],
            ["-","+","+","*","+","+"],
            ["-","+","+","*","+","-"],
            ["-","+","+","*","-","*"],
            ["-","+","+","*","-","+"],
            ["-","+","+","*","-","-"],
            ["-","+","+","+","*","*"],
            ["-","+","+","+","*","+"],
            ["-","+","+","+","*","-"],
            ["-","+","+","+","+","*"],
            ["-","+","+","+","+","+"],
            ["-","+","+","+","+","-"],
            ["-","+","+","+","-","*"],
            ["-","+","+","+","-","+"],
            ["-","+","+","+","-","-"],
            ["-","+","+","-","*","*"],
            ["-","+","+","-","*","+"],
            ["-","+","+","-","*","-"],
            ["-","+","+","-","+","*"],
            ["-","+","+","-","+","+"],
            ["-","+","+","-","+","-"],
            ["-","+","+","-","-","*"],
            ["-","+","+","-","-","+"],
            ["-","+","+","-","-","-"],
            ["-","+","-","*","*","*"],
            ["-","+","-","*","*","+"],
            ["-","+","-","*","*","-"],
            ["-","+","-","*","+","*"],
            ["-","+","-","*","+","+"],
            ["-","+","-","*","+","-"],
            ["-","+","-","*","-","*"],
            ["-","+","-","*","-","+"],
            ["-","+","-","*","-","-"],
            ["-","+","-","+","*","*"],
            ["-","+","-","+","*","+"],
            ["-","+","-","+","*","-"],
            ["-","+","-","+","+","*"],
            ["-","+","-","+","+","+"],
            ["-","+","-","+","+","-"],
            ["-","+","-","+","-","*"],
            ["-","+","-","+","-","+"],
            ["-","+","-","+","-","-"],
            ["-","+","-","-","*","*"],
            ["-","+","-","-","*","+"],
            ["-","+","-","-","*","-"],
            ["-","+","-","-","+","*"],
            ["-","+","-","-","+","+"],
            ["-","+","-","-","+","-"],
            ["-","+","-","-","-","*"],
            ["-","+","-","-","-","+"],
            ["-","+","-","-","-","-"],
            ["-","-","*","*","*","*"],
            ["-","-","*","*","*","+"],
            ["-","-","*","*","*","-"],
            ["-","-","*","*","+","*"],
            ["-","-","*","*","+","+"],
            ["-","-","*","*","+","-"],
            ["-","-","*","*","-","*"],
            ["-","-","*","*","-","+"],
            ["-","-","*","*","-","-"],
            ["-","-","*","+","*","*"],
            ["-","-","*","+","*","+"],
            ["-","-","*","+","*","-"],
            ["-","-","*","+","+","*"],
            ["-","-","*","+","+","+"],
            ["-","-","*","+","+","-"],
            ["-","-","*","+","-","*"],
            ["-","-","*","+","-","+"],
            ["-","-","*","+","-","-"],
            ["-","-","*","-","*","*"],
            ["-","-","*","-","*","+"],
            ["-","-","*","-","*","-"],
            ["-","-","*","-","+","*"],
            ["-","-","*","-","+","+"],
            ["-","-","*","-","+","-"],
            ["-","-","*","-","-","*"],
            ["-","-","*","-","-","+"],
            ["-","-","*","-","-","-"],
            ["-","-","+","*","*","*"],
            ["-","-","+","*","*","+"],
            ["-","-","+","*","*","-"],
            ["-","-","+","*","+","*"],
            ["-","-","+","*","+","+"],
            ["-","-","+","*","+","-"],
            ["-","-","+","*","-","*"],
            ["-","-","+","*","-","+"],
            ["-","-","+","*","-","-"],
            ["-","-","+","+","*","*"],
            ["-","-","+","+","*","+"],
            ["-","-","+","+","*","-"],
            ["-","-","+","+","+","*"],
            ["-","-","+","+","+","+"],
            ["-","-","+","+","+","-"],
            ["-","-","+","+","-","*"],
            ["-","-","+","+","-","+"],
            ["-","-","+","+","-","-"],
            ["-","-","+","-","*","*"],
            ["-","-","+","-","*","+"],
            ["-","-","+","-","*","-"],
            ["-","-","+","-","+","*"],
            ["-","-","+","-","+","+"],
            ["-","-","+","-","+","-"],
            ["-","-","+","-","-","*"],
            ["-","-","+","-","-","+"],
            ["-","-","+","-","-","-"],
            ["-","-","-","*","*","*"],
            ["-","-","-","*","*","+"],
            ["-","-","-","*","*","-"],
            ["-","-","-","*","+","*"],
            ["-","-","-","*","+","+"],
            ["-","-","-","*","+","-"],
            ["-","-","-","*","-","*"],
            ["-","-","-","*","-","+"],
            ["-","-","-","*","-","-"],
            ["-","-","-","+","*","*"],
            ["-","-","-","+","*","+"],
            ["-","-","-","+","*","-"],
            ["-","-","-","+","+","*"],
            ["-","-","-","+","+","+"],
            ["-","-","-","+","+","-"],
            ["-","-","-","+","-","*"],
            ["-","-","-","+","-","+"],
            ["-","-","-","+","-","-"],
            ["-","-","-","-","*","*"],
            ["-","-","-","-","*","+"],
            ["-","-","-","-","*","-"],
            ["-","-","-","-","+","*"],
            ["-","-","-","-","+","+"],
            ["-","-","-","-","+","-"],
            ["-","-","-","-","-","*"],
            ["-","-","-","-","-","+"],
            ["-","-","-","-","-","-"]
        ]
    ]
]
