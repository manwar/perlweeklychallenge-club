#!/usr/bin/env raku
#BEGIN %*ENV<RAKU_TEST_DIE_ON_FAIL> = 1;
#BEGIN %*ENV<AUTHOR_TESTING> = 1;

use Test;
use task-one;

my @testcases =
  {"year" => 2024, "month" => 4, "weekday-of-month" => 3, "day-of-week" => 2} => 16, # The 3rd Tue of Apr 2024 is the 16th
  {"year" => 2025, "month" => 10, "weekday-of-month" => 2, "day-of-week" => 4} => 9, # The 2nd Thu of Oct 2025 is the 9th
  {"year" => 2026, "month" => 8, "weekday-of-month" => 5, "day-of-week" => 3} => 0, # There isn't a 5th Wed in Aug 2026!
;

plan @testcases.elems;
cmp-ok solution(.key), &[eqv], .value for @testcases;

if ?%*ENV<AUTHOR_TESTING> {
  for @testcases.keys -> $i {
    my ($input, $output) = @testcases[$i].kv;
    say $i + 1 ~ '. testcase';
    isa-ok $input, Hash, 'domain data structure';
    ok all($input) ~~ Hash, 'domain value';
    isa-ok $output, UInt, 'co-domain data structure';
    ok all($output) ~~ UInt, 'co-domain value';    
  }
}